# Linux Server Auditor Configuration File

# General settings
general:
  version: "1.0.0"
  verbose: false
  timeout: 30
  max_concurrent_modules: 4

# Logging configuration
logging:
  level: "INFO"
  file: null
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
  date_format: "%Y-%m-%d %H:%M:%S"
  format_type: "text"
  max_file_size: 10485760  # 10MB
  backup_count: 5
  audit_file: null
  audit_max_file_size: 52428800  # 50MB
  audit_backup_count: 10

# Scoring configuration
scoring:
  # Module weights (must sum to 100)
  weight_system_info: 5.0
  weight_network_security: 15.0
  weight_user_management: 12.0
  weight_service_management: 10.0
  weight_file_permissions: 12.0
  weight_logging_monitoring: 8.0
  weight_firewall_config: 10.0
  weight_package_management: 8.0
  weight_disk_security: 10.0
  weight_kernel_security: 10.0
  
  # Severity weights for deductions
  severity_weights:
    low: 1.0
    medium: 3.0
    high: 5.0
    critical: 10.0
  
  # Grade thresholds
  grade_thresholds:
    A: 90.0
    B: 80.0
    C: 70.0
    D: 60.0
    F: 0.0

# Module configuration
modules:
  enabled: true
  timeout: 60
  retry_attempts: 2
  skip_on_error: false
  
  # Individual module settings
  system_info:
    enabled: true
    timeout: 30
    
  network_security:
    enabled: true
    timeout: 45
    check_open_ports: true
    check_services: true
    
  user_management:
    enabled: true
    timeout: 30
    check_password_policy: true
    check_sudo_privileges: true
    
  service_management:
    enabled: true
    timeout: 30
    check_running_services: true
    check_startup_services: true
    
  file_permissions:
    enabled: true
    timeout: 60
    check_critical_files: true
    check_suid_files: true
    
  logging_monitoring:
    enabled: true
    timeout: 30
    check_log_files: true
    check_log_rotation: true
    
  firewall_config:
    enabled: true
    timeout: 30
    check_firewall_status: true
    check_rules: true
    
  package_management:
    enabled: true
    timeout: 45
    check_updates: true
    check_installed_packages: true
    
  disk_security:
    enabled: true
    timeout: 30
    check_mount_options: true
    check_encryption: false
    
  kernel_security:
    enabled: true
    timeout: 30
    check_kernel_params: true
    check_patches: true

# Output configuration
output:
  default_format: "json"
  formats: ["json", "yaml", "html", "markdown"]
  include_metadata: true
  include_timestamps: true
  compress_large_outputs: true
  
  # Reporting settings
  reporting:
    template_dir: "templates"
    template_name: "audit_report.html"
    convert_markdown_to_html: false

# Security thresholds
security:
  max_failed_login_attempts: 5
  password_min_length: 8
  password_min_complexity: 3
  max_file_permissions: 644
  max_directory_permissions: 755
  
  # Critical services that should be monitored
  critical_services:
    - "sshd"
    - "httpd"
    - "nginx"
    - "mysql"
    - "postgresql"
  
  # Required security packages
  required_packages:
    - "fail2ban"
    - "auditd"
    - "firewalld"
    - "selinux"
  
  # Network security settings
  network:
    check_private_ips_only: true
    max_listening_ports: 20
    allowed_protocols: ["tcp", "udp"]
  
  # File system security
  filesystem:
    check_suid_files: true
    check_writable_files: true
    critical_paths:
      - "/etc/passwd"
      - "/etc/shadow"
      - "/etc/sudoers"
      - "/etc/ssh/sshd_config"
    
    # Paths to exclude from file permission checks
    exclude_paths:
      - "/tmp"
      - "/var/tmp"
      - "/proc"
      - "/sys"

# Performance settings
performance:
  max_memory_usage: 512  # MB
  max_cpu_usage: 50      # Percentage
  parallel_execution: true
  max_parallel_modules: 3

# Advanced settings
advanced:
  debug_mode: false
  skip_root_check: false
  ignore_errors: false
  cache_results: false
  cache_timeout: 300  # seconds

# Integration settings
integration:
  # Slack notifications
  slack:
    enabled: false
    webhook_url: ""
    channel: "#security"
  
  # Email notifications
  email:
    enabled: false
    smtp_server: ""
    smtp_port: 587
    username: ""
    password: ""
    recipients: []
  
  # SIEM integration
  siem:
    enabled: false
    endpoint: ""
    api_key: ""
    format: "json"